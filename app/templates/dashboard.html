{% extends "base.html" %}

{% block content %}
<section class="form-page">
  <div class="form-container" style="max-width: 1200px;">
    <h1>Mon tableau de bord</h1>
    <p class="subtitle">GÃ©rez vos annonces et consultez vos demandes de contact</p>

    {% if not listings %}
    <div style="background: var(--bg-light); padding: 40px; border-radius: var(--radius); text-align: center; margin-top: 32px;">
      <p style="font-size: 18px; color: var(--text-gray); margin-bottom: 24px;">
        Vous n'avez pas encore d'annonces.
      </p>
      <a href="/deposer" class="btn-primary">CrÃ©er ma premiÃ¨re annonce</a>
    </div>
    {% else %}
    <div style="margin-top: 32px;">
      <div style="display: grid; gap: 20px;">
        {% for listing in listings %}
        <div style="border: 1px solid var(--border-color); border-radius: var(--radius); padding: 20px; background: white;">
          <div style="display: flex; justify-content: space-between; align-items: start; gap: 20px;">
            <div style="flex: 1;">
              <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                <h3 style="font-size: 20px; font-weight: 700; margin: 0;">{{ listing.title }}</h3>
                {% if listing.status == 'draft' %}
                <span style="padding: 4px 12px; background: var(--text-gray); color: white; border-radius: 4px; font-size: 12px; font-weight: 600;">BROUILLON</span>
                {% elif listing.status == 'published' %}
                <span style="padding: 4px 12px; background: var(--secondary-color); color: white; border-radius: 4px; font-size: 12px; font-weight: 600;">PUBLIÃ‰E</span>
                {% elif listing.status == 'expired' %}
                <span style="padding: 4px 12px; background: var(--text-gray); color: white; border-radius: 4px; font-size: 12px; font-weight: 600;">EXPIRÃ‰E</span>
                {% elif listing.status == 'sold' %}
                <span style="padding: 4px 12px; background: var(--primary-color); color: white; border-radius: 4px; font-size: 12px; font-weight: 600;">VENDUE</span>
                {% endif %}
              </div>
              
              <p style="color: var(--text-gray); margin-bottom: 8px;">
                {{ listing.category }} â€¢ {{ listing.price_display }}
              </p>
              
              <p style="color: var(--text-gray); font-size: 14px; margin-bottom: 12px;">
                CrÃ©Ã©e le {{ listing.created_at[:10] }}
                {% if listing.published_at %}
                â€¢ PubliÃ©e le {{ listing.published_at[:10] }}
                {% endif %}
              </p>

              {% if listing.status == 'published' %}
              <div style="display: flex; align-items: center; gap: 8px; margin-top: 12px;">
                <span style="font-size: 14px; color: var(--text-gray);">
                  ðŸ“¨ {{ listing.inquiry_count or 0 }} demande(s) de contact
                </span>
              </div>
              {% endif %}
            </div>

            <div style="display: flex; gap: 12px;">
              {% if listing.status == 'published' %}
              <a href="/annonces/{{ listing.id }}" class="btn-secondary" style="padding: 8px 16px; font-size: 14px;">
                Voir l'annonce
              </a>
              {% elif listing.status == 'draft' %}
              <a href="/deposer/step1?listing_id={{ listing.id }}" class="btn-primary" style="padding: 8px 16px; font-size: 14px;">
                Reprendre
              </a>
              {% endif %}
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </div>
</section>
{% endblock %}
