{% extends "base.html" %}

{% block content %}
<section class="detail-header">
  <div class="container">
    <div class="breadcrumb">
      <a href="/">Accueil</a> / <a href="/annonces">Annonces</a> / {{ listing.title }}
    </div>
  </div>
</section>

<section class="detail-content">
  <div class="container">
    <div class="detail-grid">
      <div class="detail-main">
        <h1>{{ listing.title }}</h1>
        
        <div class="detail-meta">
          <div class="detail-meta-item">
            <span class="detail-meta-label">Cat√©gorie</span>
            <span class="detail-meta-value">{{ listing.category }}</span>
          </div>
          <div class="detail-meta-item">
            <span class="detail-meta-label">√âtat</span>
            <span class="detail-meta-value">{{ listing.condition }}</span>
          </div>
          <div class="detail-meta-item">
            <span class="detail-meta-label">Localisation</span>
            <span class="detail-meta-value">{{ listing.location }}</span>
          </div>
          {% if listing.year %}
          <div class="detail-meta-item">
            <span class="detail-meta-label">Ann√©e</span>
            <span class="detail-meta-value">{{ listing.year }}</span>
          </div>
          {% endif %}
          {% if listing.manufacturer %}
          <div class="detail-meta-item">
            <span class="detail-meta-label">Fabricant</span>
            <span class="detail-meta-value">{{ listing.manufacturer }}</span>
          </div>
          {% endif %}
        </div>

        <img src="{{ listing.image }}" alt="{{ listing.title }}" />

        <h2 style="font-size: 24px; font-weight: 700; margin-bottom: 16px; color: var(--text-dark);">Description</h2>
        <div class="detail-description">
          {% if listing.description %}
          <p>{{ listing.description }}</p>
          {% else %}
          <p>{{ listing.summary }}</p>
          {% endif %}
        </div>

        <div style="background: var(--bg-light); padding: 24px; border-radius: var(--radius-lg); margin-top: 32px;">
          <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 12px;">Informations importantes</h3>
          <ul style="list-style: none; color: var(--text-gray); line-height: 2;">
            <li>‚úì √âquipement v√©rifi√© et fonctionnel</li>
            <li>‚úì Documentation technique disponible</li>
            <li>‚úì Possibilit√© de visite sur site</li>
            <li>‚úì Assistance √† l'installation disponible</li>
          </ul>
        </div>
      </div>

      <div class="detail-sidebar">
        <div class="contact-card">
          <h3>Contacter le vendeur</h3>
          <span class="price-large">{{ listing.price_display or listing.price }}</span>
          
          <div style="margin-top: 24px; padding: 20px; background: var(--bg-light); border-radius: var(--radius);">
            <h4 style="font-size: 16px; font-weight: 700; margin-bottom: 16px; color: var(--text-dark);">
              Coordonn√©es du vendeur
            </h4>
            
            <div style="display: flex; flex-direction: column; gap: 12px;">
              <div style="display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 18px;">üìß</span>
                <a href="mailto:{{ listing.contact_email }}" 
                   style="color: var(--primary-color); text-decoration: none; font-weight: 500; word-break: break-all;">
                  {{ listing.contact_email }}
                </a>
              </div>
              
              <div style="display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 18px;">üìû</span>
                <a href="tel:{{ listing.contact_phone }}" 
                   style="color: var(--primary-color); text-decoration: none; font-weight: 500;">
                  {{ listing.contact_phone }}
                </a>
              </div>
            </div>
            
            <p style="font-size: 13px; color: var(--text-gray); margin-top: 16px; line-height: 1.5;">
              Contactez directement le vendeur par email ou t√©l√©phone pour plus d'informations sur cet √©quipement.
            </p>
          </div>
          
          <div class="contact-info" style="margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--border-color);">
            <div class="contact-info-item">
              <div class="contact-info-label">R√©f√©rence</div>
              <div class="contact-info-value">#{{ listing.id|string|truncate(8, True, '') }}</div>
            </div>
          </div>
        </div>

        <div style="background: var(--bg-light); padding: 24px; border-radius: var(--radius-lg); margin-top: 24px;">
          <h4 style="font-size: 16px; font-weight: 700; margin-bottom: 12px;">Besoin d'aide ?</h4>
          <p style="font-size: 14px; color: var(--text-gray); line-height: 1.6; margin-bottom: 16px;">
            Notre √©quipe est disponible pour vous accompagner dans votre achat.
          </p>
          <a href="/contact" class="btn-secondary" style="width: 100%; text-align: center;">Contactez-nous</a>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section" style="background: var(--bg-light);">
  <div class="container">
    <h2>Annonces similaires</h2>
    <div class="cards">
      {% for item in listings[:3] %}
      {% if item.id != listing.id %}
      <article class="card">
        <img src="{{ item.image }}" alt="{{ item.title }}" />
        <div class="card-body">
          <div style="margin-bottom: 12px;">
            <span class="badge badge-info">{{ item.category }}</span>
          </div>
          <h3>{{ item.title }}</h3>
          <p>{{ item.summary }}</p>
          <div class="meta">
            <span>üìç {{ item.location }}</span>
            <span class="price">{{ item.price_display or item.price }}</span>
          </div>
          <a class="link" href="/annonces/{{ item.id }}">Voir les d√©tails ‚Üí</a>
        </div>
      </article>
      {% endif %}
      {% endfor %}
    </div>
  </div>
</section>
{% endblock %}
