{% extends "wizard_base.html" %}

{% block wizard_content %}
<h1>D√©poser une annonce - √âtape 5/5</h1>
<p class="subtitle">V√©rifiez vos informations et ajoutez vos coordonn√©es</p>

<form method="post" action="/deposer/step5">
  <input type="hidden" name="listing_id" value="{{ draft.id }}" />
  <div style="background: var(--bg-light); padding: 24px; border-radius: var(--radius); margin-bottom: 32px;">
    <h3 style="font-size: 18px; font-weight: 700; margin-bottom: 16px;">R√©capitulatif de votre annonce</h3>
    
    <div style="display: grid; gap: 12px;">
      <div><strong>Titre :</strong> {{ draft.title }}</div>
      <div><strong>Type :</strong> {{ draft.listing_type }}</div>
      <div><strong>Cat√©gorie :</strong> {{ draft.category }}</div>
      <div><strong>√âtat :</strong> {{ draft.condition }}</div>
      {% if draft.year %}
      <div><strong>Ann√©e :</strong> {{ draft.year }}</div>
      {% endif %}
      {% if draft.manufacturer %}
      <div><strong>Fabricant :</strong> {{ draft.manufacturer }}</div>
      {% endif %}
      <div><strong>Prix :</strong> {{ draft.price_display }}</div>
      <div><strong>Localisation :</strong> {{ draft.location }}</div>
    </div>
    
    <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border-color);">
      <p style="font-size: 14px; color: var(--text-gray); margin: 0;">
        <strong>R√©sum√© :</strong> {{ draft.summary }}
      </p>
    </div>
  </div>

  <h3 style="font-size: 20px; font-weight: 700; margin-bottom: 20px;">Informations de contact</h3>
  
  <div class="form-grid">
    <div class="form-group">
      <label for="contact_email">Email *</label>
      <input type="email" id="contact_email" name="contact_email" required 
             placeholder="votre@email.fr"
             value="{{ draft.contact_email if draft and draft.contact_email else '' }}" />
    </div>

    <div class="form-group">
      <label for="contact_phone">T√©l√©phone *</label>
      <input type="tel" id="contact_phone" name="contact_phone" required 
             placeholder="+33 X XX XX XX XX"
             value="{{ draft.contact_phone if draft and draft.contact_phone else '' }}" />
    </div>
  </div>

  <div style="margin-top: 32px; padding: 20px; background: var(--secondary-color); background: rgba(16, 185, 129, 0.1); border-radius: var(--radius); border-left: 4px solid var(--secondary-color);">
    <h4 style="font-size: 16px; font-weight: 700; margin-bottom: 12px; color: var(--text-dark);">
      üí≥ Paiement de la publication
    </h4>
    <p style="font-size: 14px; color: var(--text-gray); line-height: 1.6; margin: 0;">
      Pour publier votre annonce, un paiement unique de <strong>{{ listing_price }} ‚Ç¨</strong> est requis. 
      Vous serez redirig√© vers une page de paiement s√©curis√©e Stripe. Votre annonce sera publi√©e 
      imm√©diatement apr√®s la confirmation du paiement.
    </p>
  </div>

  {% if error %}
  <div style="margin-top: 24px; padding: 20px; background: #fee; border-radius: var(--radius); border-left: 4px solid #d00;">
    <p style="font-size: 14px; color: #d00; font-weight: 600; margin: 0;">
      ‚ö†Ô∏è {{ error }}
    </p>
  </div>
  {% endif %}

  <div class="form-group" style="margin-top: 24px; border: 2px solid #f59e0b; padding: 20px; border-radius: var(--radius); background: #fffbeb;">
    <label style="display: flex; align-items: start; gap: 12px; cursor: pointer;">
      <input type="checkbox" name="consent_public_contact" required style="margin-top: 4px; min-width: 20px; min-height: 20px;" />
      <span style="font-size: 14px; line-height: 1.6; color: var(--text-dark);">
        <strong style="color: #d97706; font-size: 16px;">‚ö†Ô∏è Consentement obligatoire (RGPD)</strong><br><br>
        Je comprends et j'accepte express√©ment que mes <strong>coordonn√©es de contact (email et t√©l√©phone)</strong> 
        seront <strong style="text-decoration: underline;">publi√©es publiquement et visibles par tous</strong> 
        sur mon annonce une fois celle-ci valid√©e et pay√©e. Ces informations permettront aux acheteurs 
        potentiels de me contacter directement.<br><br>
        Je reconnais avoir pris connaissance de la 
        <a href="/politique-confidentialite" target="_blank" style="color: var(--primary-color); text-decoration: underline;">Politique de Confidentialit√©</a> 
        et des <a href="/cgv" target="_blank" style="color: var(--primary-color); text-decoration: underline;">Conditions G√©n√©rales</a>.
      </span>
    </label>
  </div>

  <div style="margin-top: 32px; display: flex; gap: 16px; justify-content: space-between;">
    <a href="/deposer/step4" class="btn-secondary">‚Üê Retour</a>
    <button type="submit" class="btn-primary">Proc√©der au paiement ‚Üí</button>
  </div>
</form>
{% endblock %}
